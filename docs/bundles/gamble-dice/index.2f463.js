window.__require=function e(t,i,n){function a(c,s){if(!i[c]){if(!t[c]){var l=c.split("/");if(l=l[l.length-1],!t[l]){var u="function"==typeof __require&&__require;if(!s&&u)return u(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var r=i[c]={exports:{}};t[c][0].call(r.exports,function(e){return a(t[c][1][e]||e)},r,r.exports,e,t,i,n)}return i[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<n.length;c++)a(n[c]);return a}({DicePanelConst:[function(e,t,i){"use strict";cc._RF.push(t,"e2cb7S3jZVHmpPAyDQctn1R","DicePanelConst"),Object.defineProperty(i,"__esModule",{value:!0}),i.DicePanelConst=void 0,i.DicePanelConst={CacheKey:"game.cache"},cc._RF.pop()},{}],DicePanelEnum:[function(e,t,i){"use strict";cc._RF.push(t,"6286c6d8RJMi6WaeU58e+oq","DicePanelEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.BetType=i.Status=void 0,function(e){e[e.Active=1]="Active",e[e.Inactive=0]="Inactive"}(i.Status||(i.Status={})),function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Big=7]="Big",e[e.Small=8]="Small"}(i.BetType||(i.BetType={})),cc._RF.pop()},{}],DicePanelEvent:[function(e,t,i){"use strict";cc._RF.push(t,"0406cxEOr9BP6fMzplo4j7I","DicePanelEvent"),Object.defineProperty(i,"__esModule",{value:!0}),i.DicePanelEvent=void 0,(i.DicePanelEvent||(i.DicePanelEvent={})).OnResultUpdate="DicePanelEvent.OnResultUpdate",cc._RF.pop()},{}],DicePanelModel:[function(e,t,i){"use strict";cc._RF.push(t,"772b2lTAARA5o/ohff6e/5g","DicePanelModel"),Object.defineProperty(i,"__esModule",{value:!0}),i.DicePanelModel=void 0,i.DicePanelModel=class{constructor(){this.diceActive=!1,this.diceResult=null,this.numbersForRandom=[],this.lastDiceResults=[]}},cc._RF.pop()},{}],DicePanelModule:[function(e,t,i){"use strict";cc._RF.push(t,"91994wdBfJG5rvyfPEb+jzS","DicePanelModule");var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function c(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(c,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(i,"__esModule",{value:!0});const a=e("./DicePanelModel"),o=e("./DicePanelEnum"),c=e("../../../scripts/HelperTools");class s extends cc.Component{static init(){this.data=new a.DicePanelModel,this.data.numbersForRandom=this.generateRangeNumber(1,6)}static getDicePanelStatus(){return this.data.diceActive}static setDicePanelStatus(e){this.data.diceActive=Boolean(e)}static setDiceResult(e){this.data.diceResult=e}static getLastDiceResults(){return this.data.lastDiceResults}static clearDiceResult(){this.data.diceResult=null,this.data.lastDiceResults=[]}static getDiceResult(e,t){return n(this,void 0,void 0,function*(){return new Promise(i=>{const n=c.Shuffle(this.data.numbersForRandom)[0],a={number:n,bigSmall:n<=3?o.BetType.Small:o.BetType.Big};let s=0;switch(e){case o.BetType.Big:case o.BetType.Small:e===a.bigSmall&&(s=2*t);break;case o.BetType.One:case o.BetType.Two:case o.BetType.Three:case o.BetType.Four:case o.BetType.Five:case o.BetType.Six:e===a.number&&(s=6*t)}const l={betType:a.number,winAmount:s};this.setDiceResult(l),this.addLastDiceResult(l.betType),i(l)})})}static addLastDiceResult(e){this.data.lastDiceResults.length>=8&&this.data.lastDiceResults.shift(),this.data.lastDiceResults.push(e)}static generateRangeNumber(e,t){const i=[];for(let n=e;n<=t;n++)i.push(n);return i}}i.default=s,s.data=null,cc._RF.pop()},{"../../../scripts/HelperTools":void 0,"./DicePanelEnum":"DicePanelEnum","./DicePanelModel":"DicePanelModel"}],DicePanelPrefab:[function(e,t,i){"use strict";cc._RF.push(t,"14b40h61EdPPqMlcHf02nRF","DicePanelPrefab");var n=this&&this.__decorate||function(e,t,i,n){var a,o=arguments.length,c=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(c=(o<3?a(c):o>3?a(t,i,c):a(t,i))||c);return o>3&&c&&Object.defineProperty(t,i,c),c},a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function c(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(c,s)}l((n=n.apply(e,t||[])).next())})},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0});const c=e("../../../scripts/framework/lib/router/PanelComponent"),s=e("../../../scripts/HelperTools"),l=o(e("../../../scripts/manager/AudioManager")),u=o(e("../../../scripts/manager/GameSystemManager")),r=e("./DicePanelEnum"),d=o(e("./DicePanelModule")),{ccclass:p,property:h}=cc._decorator;let m=class extends c.PanelComponent{constructor(){super(...arguments),this.diceGroup=null,this.currentDiceResult=null,this.btnTakeWin=null,this.lastResults=null,this.diceAtlas=null,this.cupOpenAnimation=null,this.cupShakeAnimation=null,this.cupButtom=null,this.shaziSound=null,this.gameWinSound=null,this.gameLooseSound=null,this.dummyPlayerBalanceManager={balance:0},this.labelLayer={LabelBank:null,LabelMultiply2To:null,LabelMultiply6To:null},this.smallBettingGroup=[],this.bigBettingGroup=[]}start(){return a(this,void 0,void 0,function*(){yield this.loadDiceAssets(),this.setupDiceModule()})}show(e){e.onShowed()}hide(e){e.onHided()}activeDicePanel(){return a(this,void 0,void 0,function*(){this.dummyPlayerBalanceManager.balance<=0&&(this.dummyPlayerBalanceManager.balance=13.31),l.default.getInstance().play("ClickSound"),this.resetBettingUI(),d.default.setDicePanelStatus(r.Status.Active),this.diceGroup.active=!0,this.disableCommonButtons(),this.disableBettingButtons(),yield this.playCupShakeAimation(),this.enableCommonButtons(),this.enableBettingButtons()})}inActiveDicePanel(){d.default.setDicePanelStatus(r.Status.Inactive),this.diceGroup.active=!1}takeWin(){this.inActiveDicePanel()}placeBet(e,t){return a(this,void 0,void 0,function*(){l.default.getInstance().play("ClickSound"),this.disableCommonButtons(),this.disableBettingButtons();const e=yield d.default.getDiceResult(Number(t),this.dummyPlayerBalanceManager.balance);this.showDiceResult(e),yield this.playCupOpenAimation(e),this.dummyPlayerBalanceManager.balance=e.winAmount,e.winAmount>0?(yield s.Delay(.25),yield this.playCupShakeAimation(),this.resetBettingUI()):(yield s.Delay(2),this.inActiveDicePanel())})}resetBettingUI(){this.enableCommonButtons(),this.enableBettingButtons(),this.updateBettingInfomation(),this.updateBank()}showDiceResult(e){const t=this.getDiceSpriteFrame(e.betType);this.currentDiceResult.spriteFrame=t.bigDice}playCupShakeAimation(){return a(this,void 0,void 0,function*(){yield s.AsyncTask(e=>{l.default.getInstance().play("ShaziSound"),this.cupButtom.node.active=!1,this.cupShakeAnimation.node.active=!0,this.cupShakeAnimation.play(),this.cupShakeAnimation.once(cc.Animation.EventType.FINISHED,()=>{this.cupButtom.node.active=!0,this.cupShakeAnimation.node.active=!1,e()})})})}playCupOpenAimation(e){return a(this,void 0,void 0,function*(){yield s.AsyncTask(t=>{this.cupOpenAnimation.play().wrapMode=cc.WrapMode.Normal,this.scheduleOnce(()=>{e.winAmount>0?l.default.getInstance().play("GameWinSound"):l.default.getInstance().play("GameLooseSound")},.4),this.cupOpenAnimation.once(cc.Animation.EventType.FINISHED,()=>a(this,void 0,void 0,function*(){yield s.Delay(2),this.updateLastCardsResult(),t()}))}),yield s.AsyncTask(e=>{this.cupOpenAnimation.play().wrapMode=cc.WrapMode.Reverse,this.cupOpenAnimation.once(cc.Animation.EventType.FINISHED,()=>{e()})})})}setupDiceModule(){d.default.init(),this.cacheBettingGroupButton(),this.cacheLabellayer(),l.default.getInstance().add("ShaziSound",this.shaziSound),l.default.getInstance().add("GameWinSound",this.gameWinSound),l.default.getInstance().add("GameLooseSound",this.gameLooseSound)}cacheBettingGroupButton(){const e=cc.find("Buttons/SmallBettingGroup",this.diceGroup).children;for(const i of e)this.smallBettingGroup.push(i.getComponent(cc.Button));const t=cc.find("Buttons/BigBettingGroup",this.diceGroup).children;for(const i of t)this.bigBettingGroup.push(i.getComponent(cc.Button))}cacheLabellayer(){const e=cc.find("LabelLayer",this.diceGroup);this.labelLayer.LabelBank=e.getChildByName("LabelBank").getComponent(cc.Label),this.labelLayer.LabelMultiply2To=e.getChildByName("LabelMultiply2To").getComponent(cc.Label),this.labelLayer.LabelMultiply6To=e.getChildByName("LabelMultiply6To").getComponent(cc.Label)}getDiceSpriteFrame(e){const t=this.diceAtlas.getSpriteFrame("History_"+s.Pad(e,2)),i=this.getDiceWithDifferentAngle(e);return{smallDice:t,bigDice:this.diceAtlas.getSpriteFrame("Result_"+s.Pad(i,2))}}getDiceWithDifferentAngle(e){const t=4*e,i=t-3;return s.GetRandomInterger(i,t)}enableCommonButtons(){this.btnTakeWin.node.active=!0}disableCommonButtons(){this.btnTakeWin.node.active=!1}enableBettingButtons(){for(const e of this.smallBettingGroup)e.enabled=!0;for(const e of this.bigBettingGroup)e.enabled=!0}disableBettingButtons(){for(const e of this.smallBettingGroup)e.enabled=!1;for(const e of this.bigBettingGroup)e.enabled=!1}updateBettingInfomation(){const e=this.dummyPlayerBalanceManager.balance;this.labelLayer.LabelMultiply2To.string=s.BeautifyNumber(2*e,2),this.labelLayer.LabelMultiply6To.string=s.BeautifyNumber(6*e,2)}updateBank(){this.labelLayer.LabelBank.string=s.BeautifyNumber(this.dummyPlayerBalanceManager.balance,2)}updateLastCardsResult(){const e=d.default.getLastDiceResults();for(let t=0,i=e.length;t<i;t++){const i=this.lastResults.children[t],n=e[t],a=this.getDiceSpriteFrame(n);i.active=!0,i.getComponent(cc.Sprite).spriteFrame=a.smallDice}}loadDiceAssets(){return a(this,void 0,void 0,function*(){return new Promise(e=>{cc.assetManager.loadBundle("gamble-dice",(t,i)=>{if(t)return console.error(t);const n=`textures/${u.default.getInstance().getLanguageCode()}`,o=s.AsyncTask(e=>a(this,void 0,void 0,function*(){i.load(`${n}/Gamble`,cc.SpriteAtlas,(t,i)=>{const n=cc.find("SafeArea/ActivateButtons/BtnDemoDice",this.node).getComponent(cc.Button);s.UItools.ChangeButtonSpriteFrame(n,i,{normalSprite:"Gamble1",pressedSprite:"Gamble3"}),e()})}));Promise.all([o]).then(()=>{e()})})})})}};n([h(cc.Node)],m.prototype,"diceGroup",void 0),n([h(cc.Sprite)],m.prototype,"currentDiceResult",void 0),n([h(cc.Button)],m.prototype,"btnTakeWin",void 0),n([h(cc.Node)],m.prototype,"lastResults",void 0),n([h(cc.SpriteAtlas)],m.prototype,"diceAtlas",void 0),n([h(cc.Animation)],m.prototype,"cupOpenAnimation",void 0),n([h(cc.Animation)],m.prototype,"cupShakeAnimation",void 0),n([h(cc.Sprite)],m.prototype,"cupButtom",void 0),n([h(cc.AudioClip)],m.prototype,"shaziSound",void 0),n([h(cc.AudioClip)],m.prototype,"gameWinSound",void 0),n([h(cc.AudioClip)],m.prototype,"gameLooseSound",void 0),m=n([p],m),i.default=m,cc._RF.pop()},{"../../../scripts/HelperTools":void 0,"../../../scripts/framework/lib/router/PanelComponent":void 0,"../../../scripts/manager/AudioManager":void 0,"../../../scripts/manager/GameSystemManager":void 0,"./DicePanelEnum":"DicePanelEnum","./DicePanelModule":"DicePanelModule"}]},{},["DicePanelConst","DicePanelEnum","DicePanelEvent","DicePanelModel","DicePanelModule","DicePanelPrefab"]);