window.__require=function t(e,n,i){function a(o,l){if(!n[o]){if(!e[o]){var r=o.split("/"),c=r,d=o;if(c=c[c.length-1],r.length>1&&(window.cachePath[c]=o),!e[c]){var u="function"==typeof __require&&__require;if(!l&&u)return u(c,!0);if(s)return s(c,!0);if("object"==typeof __quick_compile_project__&&__quick_compile_project__){var h=window.cachePath[c];h&&(d=h);for(var p=d.split("/"),m="",g=p.length;g>0;)p[g]&&".."!=p[g]&&(m="/"+p[g]+m),g--;return c="./assets"+m,__quick_compile_project__.require(c,"preview-scripts/__qc_index__.js")}throw new Error("Cannot find module '"+o+"'")}o=c}var b=n[o]={exports:{}};e[o][0].call(b.exports,function(t){return a(e[o][1][t]||t)},b,b.exports,t,e,n,i)}return n[o].exports}window.cachePath={};for(var s="function"==typeof __require&&__require,o=0;o<i.length;o++)a(i[o]);return a}({Kiss918RedBlackPanelEnum_LR:[function(t,e,n){"use strict";cc._RF.push(e,"8d430VvsDVDxo0bsKGKhFW9","Kiss918RedBlackPanelEnum_LR"),Object.defineProperty(n,"__esModule",{value:!0}),n.Kiss918Choices_LR=void 0,function(t){t[t.Red=1]="Red",t[t.Black=2]="Black"}(n.Kiss918Choices_LR||(n.Kiss918Choices_LR={})),cc._RF.pop()},{}],Kiss918RedBlackPanelModel_LR:[function(t,e,n){"use strict";cc._RF.push(e,"482cbqDkotBz4tmNpDW5+RK","Kiss918RedBlackPanelModel_LR"),Object.defineProperty(n,"__esModule",{value:!0}),n.Kiss918RedBlackPanelModel_LR=void 0,n.Kiss918RedBlackPanelModel_LR=class{constructor(){this.redBlackActive=!1,this.redBlackResult=null,this.lastCardResults=[]}},cc._RF.pop()},{}],Kiss918RedBlackPanelModule_LR:[function(t,e,n){"use strict";cc._RF.push(e,"d8c536LIuJJBpw9lVD/xcbE","Kiss918RedBlackPanelModule_LR");var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(a,s){function o(t){try{r(i.next(t))}catch(e){s(e)}}function l(t){try{r(i.throw(t))}catch(e){s(e)}}function r(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,l)}r((i=i.apply(t,e||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const a=t("../../../../../../scripts/HelperTools"),s=t("./Kiss918RedBlackPanelEnum_LR"),o=t("./Kiss918RedBlackPanelModel_LR");class l extends cc.Component{static init(){this.data=new o.Kiss918RedBlackPanelModel_LR}static getRedBlackPanelStatus(){return this.data.redBlackActive}static setRedBlackPanelStatus(t){this.data.redBlackActive=t}static setRedBlackResult(t){this.data.redBlackResult=t}static getLastCardsResults(){return this.data.lastCardResults}static clearRedBlackResult(){this.data.redBlackResult=null,this.data.lastCardResults=[]}static getRedBlackResult(t,e){return i(this,void 0,void 0,function*(){return new Promise(n=>{const i=a.GetRandomInterger(1,52)<=26?s.Kiss918Choices_LR.Black:s.Kiss918Choices_LR.Red;let o=0;t===i&&(o=2*e);const l={cardResult:i,winAmount:o/2,playerBalance:o};this.setRedBlackResult(l),this.addLastCardResult(l.cardResult),n(l)})})}static addLastCardResult(t){this.data.lastCardResults.length>=5&&this.data.lastCardResults.shift(),this.data.lastCardResults.push(t)}}n.default=l,l.data=null,cc._RF.pop()},{"../../../../../../scripts/HelperTools":void 0,"./Kiss918RedBlackPanelEnum_LR":"Kiss918RedBlackPanelEnum_LR","./Kiss918RedBlackPanelModel_LR":"Kiss918RedBlackPanelModel_LR"}],Kiss918RedBlackPanelPrefab_LR:[function(t,e,n){"use strict";cc._RF.push(e,"c8388Ak+NxDxpktcpd1Ql5e","Kiss918RedBlackPanelPrefab_LR");var i=this&&this.__decorate||function(t,e,n,i){var a,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(o=(s<3?a(o):s>3?a(e,n,o):a(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(a,s){function o(t){try{r(i.next(t))}catch(e){s(e)}}function l(t){try{r(i.throw(t))}catch(e){s(e)}}function r(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,l)}r((i=i.apply(t,e||[])).next())})},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});const o=t("../../../../../../scripts/framework/gg"),l=t("../../../../../../scripts/HelperTools"),r=s(t("../../../../../../scripts/manager/AudioManager")),c=t("../../../../../../scripts/manager/CreditCoinConvertorManager"),d=s(t("../../../../../../scripts/manager/GameSystemManager")),u=t("../../../../standardized/gamble-button/scripts/GambleButtonEvent"),h=t("./Kiss918RedBlackPanelEnum_LR"),p=s(t("./Kiss918RedBlackPanelModule_LR")),{ccclass:m,property:g}=cc._decorator;let b=class extends cc.Component{constructor(){super(...arguments),this.brand="kiss918",this.redBlackGroup=null,this.btnCollect=null,this.btnRed=null,this.btnBlack=null,this.idleAnim=null,this.labelBank=null,this.labelWinAmount=null,this.currentResult=null,this.lastResults=null,this.resultLabel=null,this.cardAtlas=null,this.mainSpriteAtlas=null,this.playerInfoManager={factorValue:0,played:!1},this.betInfoManager={win:0,bet:0,double:0},this.audioInfo={genClick:"Sfx_ButtonClicks",bgm:"Sfx_Gamble_BGM",cardAnim:"",pick:"Sfx_Gamble_Pick_Click",win:"Sfx_Gamble_WIN",lose:"Sfx_Gamble_LOSE"},this.onReceiveWinAmountUpdateEvent=t=>{if(this.resetPlayerInfoManager(),this.resetBetInfoManager(),-1===t){const t=5;this.updateBetInfoManager(0,t)}else this.updateBetInfoManager(0,t)},this.hideGambleButton=()=>{o.gg.eventManager.emit(u.GambleButtonEvent.Hide)}}onLoad(){this.registerEvent(),this.setupProperty()}start(){return a(this,void 0,void 0,function*(){this.setupRedBlackModule(),yield this.loadRedBlackAssets()})}activeGamblePanel(){this.clearUpPreviousPresentation(),p.default.setRedBlackPanelStatus(!0),this.redBlackGroup.active=!0,this.playAudio(this.audioInfo.bgm,!0),this.resetUI(),this.HandleTargetNode(this.btnCollect,!0),this.updateLastCardsResult(),this.handleAllButtonsInteraction(!0)}inActiveRedBlackPanel(){this.stopCardResultAnimation(),this.handleAllButtonsInteraction(!1),this.stopAudio(this.audioInfo.bgm),o.gg.eventManager.emit(u.GamblePanelEvent.Complete,this.finalWinAmount),p.default.setRedBlackPanelStatus(!1),this.redBlackGroup.active=!1}pickedRed(){return a(this,void 0,void 0,function*(){this.playAudio(this.audioInfo.pick),this.handleAllButtonsInteraction(!1),this.HandleTargetNode(this.btnCollect,!1),this.displayIdle(1);const t=yield this.getRedBlackResult(h.Kiss918Choices_LR.Red);this.showResult(t)})}pickedBlack(){return a(this,void 0,void 0,function*(){this.playAudio(this.audioInfo.pick),this.handleAllButtonsInteraction(!1),this.HandleTargetNode(this.btnCollect,!1),this.displayIdle(2);const t=yield this.getRedBlackResult(h.Kiss918Choices_LR.Black);this.showResult(t)})}collectMoney(){this.playAudio(this.audioInfo.genClick),this.inActiveRedBlackPanel()}showResult(t){return a(this,void 0,void 0,function*(){const e=t.winAmount>0;this.updatePlayerInfoManager(t.winAmount),e&&this.updateBetInfoManager(t.winAmount,2*t.winAmount),this.updateBettingLabelResult(t),yield this.updateCurrentCardsResult(t),this.updateLastCardsResult(),yield l.Delay(2),this.resetUI(),e?(this.HandleTargetNode(this.btnCollect,!0),this.handleAllButtonsInteraction(!0)):this.inActiveRedBlackPanel()})}getRedBlackResult(t){return p.default.getRedBlackResult(t,this.betAmount)}clearUpPreviousPresentation(){o.gg.eventManager.emit("HUDPrefab.onWiningLineAndSymbolClear"),r.default.getInstance().stopAll(),this.playAudio(this.audioInfo.genClick)}get factorValue(){return this.playerInfoManager.factorValue}get finalWinAmount(){return this.playerInfoManager.played?this.betAmount*this.factorValue:0}updatePlayerInfoManager(t){this.playerInfoManager.played=!0,this.playerInfoManager.factorValue=t>0?1:-1}resetPlayerInfoManager(){this.playerInfoManager={factorValue:1,played:!1}}get betWinAmount(){return this.betInfoManager.win}get betAmount(){return this.betInfoManager.bet}get doubleBetAmount(){return this.betInfoManager.double}updateBetInfoManager(t,e){this.betInfoManager.win+=t,this.betInfoManager.bet=e,this.betInfoManager.double=2*e}resetBetInfoManager(){this.betInfoManager={win:0,bet:0,double:0}}updateBettingLabelResult(t){t.winAmount>0&&this.updateBettingInfomation()}updateBettingInfomation(){this.labelBank.string=c.CCConvertor(this.betAmount.toFixed(2)),this.labelWinAmount.string=c.CCConvertor(this.betWinAmount.toFixed(2))}resetUI(){this.playWinOrLose(!1,!0),this.updateBettingInfomation(),this.labelWinAmount.string=c.CCConvertor((0).toFixed(2)),this.playCardResultAnimation()}handleAllButtonsInteraction(t){this.btnRed.interactable=t,this.btnRed.enabled=t,this.btnBlack.interactable=t,this.btnBlack.enabled=t,this.btnCollect.interactable=t,this.btnCollect.enabled=t}HandleTargetNode(t,e){t&&(t.node.active=e)}updateLastCardsResult(){const t=p.default.getLastCardsResults();for(let e=0,n=t.length;e<n;e++){const n=this.lastResults.children[e],i=t[e],a=this.getCardSpriteFrame(i);n.active=!0,n.getComponent(cc.Sprite).spriteFrame=a}}updateCurrentCardsResult(t){return a(this,void 0,void 0,function*(){this.stopCardResultAnimation();const e=t.winAmount>0,n=t.cardResult===h.Kiss918Choices_LR.Red?"revealRed":"revealBlack",i=this.currentResult.getComponent(cc.Animation).play(n,0);yield l.Delay(i.duration),this.playWinOrLose(e),this.playAudio(e?this.audioInfo.win:this.audioInfo.lose)})}getCardSpriteFrame(t){const e=t===h.Kiss918Choices_LR.Red?"DoubleBg_06":"DoubleBg_07";return this.cardAtlas.getSpriteFrame(e)}playCardResultAnimation(){this.playIdle(!0),this.playAudio(this.audioInfo.cardAnim),this.currentResult.spriteFrame=this.cardAtlas.getSpriteFrame("Black_01")}stopCardResultAnimation(){this.playIdle(!1),this.stopAudio(this.audioInfo.cardAnim),this.currentResult.spriteFrame=this.cardAtlas.getSpriteFrame("Black_01")}playIdle(t){const e=this.idleAnim.getClips()[0].name;t?this.idleAnim.play(e,0):this.idleAnim.stop()}displayIdle(t){const e=t===h.Kiss918Choices_LR.Red;this.idleAnim.node.getChildByName("Red").active=e,this.idleAnim.node.getChildByName("Black").active=!e}playWinOrLose(t,e=!1){const n=this.resultLabel.getChildByName("Win"),i=this.resultLabel.getChildByName("Lose");n.active=t,i.active=!t,e&&(n.active=t,i.active=t)}playAudio(t,e=!1){t&&r.default.getInstance().play(t,e)}stopAudio(t){t&&r.default.getInstance().stop(t)}registerEvent(){o.gg.eventManager.on("HUDPrefab.onWiningLineAndSymbolClear",this.hideGambleButton,this),o.gg.eventManager.on("SlotEnginePrefab.OnSpinStarted",this.hideGambleButton,this),o.gg.eventManager.on("SlotEnginePrefab.OnSpinStartedByReel",this.hideGambleButton,this),o.gg.eventManager.on(u.GamblePanelEvent.UpdateStartingAmount,this.onReceiveWinAmountUpdateEvent,this),o.gg.eventManager.on(u.GamblePanelEvent.Start,this.activeGamblePanel,this)}setupRedBlackModule(){p.default.init()}setupProperty(){this.registerButtonCallback(this.btnRed,()=>{this.pickedRed()}),this.registerButtonCallback(this.btnBlack,()=>{this.pickedBlack()}),this.registerButtonCallback(this.btnCollect,()=>{this.collectMoney()})}registerButtonCallback(t,e){t.node.on("click",e)}changeSpriteFrame(t,e){const n=this.mainSpriteAtlas.getSpriteFrame(e);t&&n&&(t.spriteFrame=n)}changeButtonSprite(t,e){t&&l.UItools.ChangeButtonSpriteFrame(t,this.mainSpriteAtlas,{normalSprite:e+"_01",pressedSprite:e+"_02",disabledSprite:e+"_03"})}getAllAudioPath(){const t=[];return this.audioInfo.bgm&&t.push("common/sounds/"+this.audioInfo.bgm),this.audioInfo.pick&&t.push("common/sounds/"+this.audioInfo.pick),this.audioInfo.cardAnim&&t.push("common/sounds/"+this.audioInfo.cardAnim),this.audioInfo.win&&t.push("common/sounds/"+this.audioInfo.win),this.audioInfo.lose&&t.push("common/sounds/"+this.audioInfo.lose),t}loadRedBlackAssets(){return a(this,void 0,void 0,function*(){return new Promise(t=>{const e=this.brand+"-gamble-redblack-".concat("laura");cc.assetManager.loadBundle(e,(e,n)=>{if(e)return console.error(e);d.default.getInstance().getLanguageCode();const i=l.AsyncTask(t=>a(this,void 0,void 0,function*(){n.load(this.getAllAudioPath(),cc.AudioClip,(t,e)=>{for(const n of e)r.default.getInstance().add(n.name,n)}),t()}));Promise.all([i]).then(()=>{t()})})})})}};i([g()],b.prototype,"brand",void 0),i([g(cc.Node)],b.prototype,"redBlackGroup",void 0),i([g(cc.Button)],b.prototype,"btnCollect",void 0),i([g(cc.Button)],b.prototype,"btnRed",void 0),i([g(cc.Button)],b.prototype,"btnBlack",void 0),i([g(cc.Animation)],b.prototype,"idleAnim",void 0),i([g(cc.Label)],b.prototype,"labelBank",void 0),i([g(cc.Label)],b.prototype,"labelWinAmount",void 0),i([g(cc.Sprite)],b.prototype,"currentResult",void 0),i([g(cc.Node)],b.prototype,"lastResults",void 0),i([g(cc.Node)],b.prototype,"resultLabel",void 0),i([g(cc.SpriteAtlas)],b.prototype,"cardAtlas",void 0),b=i([m],b),n.default=b,cc._RF.pop()},{"../../../../../../scripts/HelperTools":void 0,"../../../../../../scripts/framework/gg":void 0,"../../../../../../scripts/manager/AudioManager":void 0,"../../../../../../scripts/manager/CreditCoinConvertorManager":void 0,"../../../../../../scripts/manager/GameSystemManager":void 0,"../../../../standardized/gamble-button/scripts/GambleButtonEvent":void 0,"./Kiss918RedBlackPanelEnum_LR":"Kiss918RedBlackPanelEnum_LR","./Kiss918RedBlackPanelModule_LR":"Kiss918RedBlackPanelModule_LR"}],LauraGambleButton:[function(t,e,n){"use strict";cc._RF.push(e,"9514abPcIZKk7mNGqYa4xik","LauraGambleButton");var i=this&&this.__decorate||function(t,e,n,i){var a,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(o=(s<3?a(o):s>3?a(e,n,o):a(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o},a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(a,s){function o(t){try{r(i.next(t))}catch(e){s(e)}}function l(t){try{r(i.throw(t))}catch(e){s(e)}}function r(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,l)}r((i=i.apply(t,e||[])).next())})},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});const o=t("../../../../../../scripts/framework/gg"),l=t("../../../../../../scripts/HelperTools"),r=s(t("../../../../../../scripts/manager/AudioManager")),c=t("../../../../standardized/gamble-button/scripts/GambleButtonEvent"),{ccclass:d,property:u}=cc._decorator;var h;(function(t){t[t.Kiss918=0]="Kiss918",t[t.Mega888=1]="Mega888"})(h||(h={}));let p=class extends cc.Component{constructor(){super(...arguments),this.brand=h.Kiss918,this.gambleBtnSFX="Sfx_ButtonClicks",this.atlas=null,this.btnGamble=null,this.isActive=!1,this.onGambleButtonClicked=()=>{this.playGeneralClickSFX(),this.hideGambleButton(),o.gg.eventManager.emit(c.GamblePanelEvent.Start),o.gg.eventManager.emit("BigWinAnimPrefab.closeBigWin"),o.gg.eventManager.emit("BigWinAnim.OnSpaceOrSpinButtonDown")},this.showGambleButton=t=>{this.isActive||(this.isActive=!0,this.transitionInGambleButton(),t&&t())},this.hideGambleButton=t=>{this.isActive&&(this.isActive=!1,this.transitionOutGambleButton(),t&&t())},this.updateGambleButtonBrand=t=>{this.brand,t.indexOf("918")>-1?this.brand=h.Kiss918:t.indexOf("888")>-1&&(this.brand=h.Mega888),this.brand}}get brandType(){return this.brand}get gambleButton(){return this.btnGamble}get isActiveState(){return this.isActive}onLoad(){this.setupGambleButton(),this.registerEvent()}start(){return a(this,void 0,void 0,function*(){})}playGeneralClickSFX(){this.playAudio(this.gambleBtnSFX)}playAudio(t,e=!1){t&&r.default.getInstance().play(t,e)}stopAudio(t){t&&r.default.getInstance().stop(t)}transitionInGambleButton(){this.btnGamble.node.active=!0,cc.tween(this.btnGamble.node).set({x:730}).to(.5,{x:555},{easing:"sineOut"}).call(()=>{this.btnGamble.interactable=!0}).start()}transitionOutGambleButton(){this.btnGamble.interactable=!1,cc.tween(this.btnGamble.node).set({x:555}).to(.5,{x:730},{easing:"sineOut"}).call(()=>{this.btnGamble.node.active=!1}).start()}setupGambleButton(){const t=cc.instantiate(new cc.Node("ActivationButtonGroup"));t.setParent(this.node.children[0]),t.setSiblingIndex(0),this.btnGamble=this.generateGambleButton(t,this.onGambleButtonClicked)}generateGambleButton(t,e){const n=cc.instantiate(new cc.Node("GambleButton"));n.setParent(t),n.setPosition(730,-215),n.setScale(1,1);const i=n.addComponent(cc.Sprite);i.type=cc.Sprite.Type.SIMPLE,i.sizeMode=cc.Sprite.SizeMode.RAW;const a=n.addComponent(cc.Button);return a.transition=cc.Button.Transition.SPRITE,a.node.on("click",e),n.addComponent(cc.Animation),l.UItools.ChangeButtonSpriteFrame(a,this.atlas,{normalSprite:"double",pressedSprite:"double1",disabledSprite:"double2"}),a}registerEvent(){o.gg.eventManager.on(c.GambleButtonEvent.Show,this.showGambleButton,this),o.gg.eventManager.on(c.GambleButtonEvent.Hide,this.hideGambleButton,this),o.gg.eventManager.on(c.GambleButtonEvent.UpdateBrand,this.updateGambleButtonBrand,this)}};i([u({type:cc.Enum(h)})],p.prototype,"brand",void 0),i([u()],p.prototype,"gambleBtnSFX",void 0),i([u(cc.SpriteAtlas)],p.prototype,"atlas",void 0),p=i([d],p),n.default=p,cc._RF.pop()},{"../../../../../../scripts/HelperTools":void 0,"../../../../../../scripts/framework/gg":void 0,"../../../../../../scripts/manager/AudioManager":void 0,"../../../../standardized/gamble-button/scripts/GambleButtonEvent":void 0}]},{},["Kiss918RedBlackPanelEnum_LR","Kiss918RedBlackPanelModel_LR","Kiss918RedBlackPanelModule_LR","Kiss918RedBlackPanelPrefab_LR","LauraGambleButton"]);