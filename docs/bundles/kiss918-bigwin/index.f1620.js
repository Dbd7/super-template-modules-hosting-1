window.__require=function i(n,e,t){function a(r,c){if(!e[r]){if(!n[r]){var s=r.split("/");if(s=s[s.length-1],!n[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(o)return o(s,!0);if("object"==typeof __quick_compile_project__&&__quick_compile_project__){for(var g=r.split("/"),m="",p=g.length;p>0;)g[p]&&".."!=g[p]&&(m="/"+g[p]+m),p--;return s="./assets"+m,__quick_compile_project__.require(s,"preview-scripts/__qc_index__.js")}throw new Error("Cannot find module '"+r+"'")}r=s}var u=e[r]={exports:{}};n[r][0].call(u.exports,function(i){return a(n[r][1][i]||i)},u,u.exports,i,n,e,t)}return e[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<t.length;r++)a(t[r]);return a}({Kiss918BigWinAnimEnum:[function(i,n,e){"use strict";cc._RF.push(n,"177a2EqAmJM2ZJG8B5W74Z/","Kiss918BigWinAnimEnum"),Object.defineProperty(e,"__esModule",{value:!0}),e.BigWinType=void 0,function(i){i[i.None=0]="None",i[i.BigWin=1]="BigWin",i[i.MegaBigWin=2]="MegaBigWin",i[i.SuperBigWin=3]="SuperBigWin",i[i.UltraBigWin=4]="UltraBigWin",i[i.UltraMegaBigWin=5]="UltraMegaBigWin"}(e.BigWinType||(e.BigWinType={})),cc._RF.pop()},{}],Kiss918BigWinAnimModel:[function(i,n,e){"use strict";cc._RF.push(n,"bef928AwA9AnoMWqy2F0rra","Kiss918BigWinAnimModel"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.gameResult=null}},cc._RF.pop()},{}],Kiss918BigWinAnimModule:[function(i,n,e){"use strict";cc._RF.push(n,"760cdGIMc9Aa5DuV5/jDO/1","Kiss918BigWinAnimModule");var t=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0});const a=i("./Kiss918BigWinAnimEnum"),o=t(i("./Kiss918BigWinAnimModel"));class r{static init(){this.data=new o.default}static getBigWinType(i,n){if(0===i)return a.BigWinType.None;const e=i/n;return e>=15&&e<50?a.BigWinType.BigWin:e>=50&&e<100?a.BigWinType.MegaBigWin:e>=100&&e<150?a.BigWinType.SuperBigWin:e>=150&&e<200?a.BigWinType.UltraBigWin:e>=200?a.BigWinType.UltraMegaBigWin:a.BigWinType.None}}e.default=r,r.data=null,cc._RF.pop()},{"./Kiss918BigWinAnimEnum":"Kiss918BigWinAnimEnum","./Kiss918BigWinAnimModel":"Kiss918BigWinAnimModel"}],Kiss918BigWinAnimPrefab:[function(i,n,e){"use strict";cc._RF.push(n,"2f344CZAeNOWJ9gdm9VRpND","Kiss918BigWinAnimPrefab");var t=this&&this.__decorate||function(i,n,e,t){var a,o=arguments.length,r=o<3?n:null===t?t=Object.getOwnPropertyDescriptor(n,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,n,e,t);else for(var c=i.length-1;c>=0;c--)(a=i[c])&&(r=(o<3?a(r):o>3?a(n,e,r):a(n,e))||r);return o>3&&r&&Object.defineProperty(n,e,r),r},a=this&&this.__awaiter||function(i,n,e,t){return new(e||(e=Promise))(function(a,o){function r(i){try{s(t.next(i))}catch(n){o(n)}}function c(i){try{s(t.throw(i))}catch(n){o(n)}}function s(i){var n;i.done?a(i.value):(n=i.value,n instanceof e?n:new e(function(i){i(n)})).then(r,c)}s((t=t.apply(i,n||[])).next())})},o=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0});const r=i("../../../../scripts/framework/gg"),c=i("../../../../scripts/GlobalData"),s=i("../../../../scripts/HelperTools"),l=o(i("../../../../scripts/manager/AudioManager")),g=o(i("../../../../scripts/manager/EventQueueManager")),m=i("./Kiss918BigWinAnimEnum"),p=o(i("./Kiss918BigWinAnimModule")),u=o(i("./Kiss918FireworkPrefab")),{ccclass:d,property:h}=cc._decorator;let f=class extends cc.Component{constructor(){super(...arguments),this.bigWinBackground=null,this.bigWinGroup=null,this.bigWinDecoration01=null,this.bigWinDecoration02=null,this.bigWinLight=null,this.bigWinGraphicText=null,this.coinRainPrefab01=null,this.coinRainPrefab02=null,this.coinRainPrefab03=null,this.coinRainPrefab04=null,this.main={bigWinGroup:null,bigWinBackground:null,bigWinGraphicTextAnim:null,bigWinDecorationAnim01:null,bigWinDecorationAnim02:null,bigWinLightAnim:null,coinRainPrefab01:null,coinRainPrefab02:null,coinRainPrefab03:null,coinRainPrefab04:null,animationConfig:null},this.num=0,this.array=[20,80,130,190,210]}onLoad(){this.setupAnimationConfig(),this.cachePropertyNode(),this.cacheAnimationNode(),this.registerEvent()}test(){this.showBigWinAnimation(this.array[this.num],1),this.num++}start(){return a(this,void 0,void 0,function*(){yield this.loadBigWinAnimAssets(),this.setupBigWinAnimModule()})}checkBigWinCondition(i,n){return a(this,void 0,void 0,function*(){p.default.getBigWinType(i,n)!==m.BigWinType.None&&(c.GlobalData.flags.bigWinShowing=!0)})}showBigWinAnimation(i,n){return a(this,void 0,void 0,function*(){const e=p.default.getBigWinType(i,n);let t=0;if(e===m.BigWinType.None)return;l.default.getInstance().play("STD_ALLWIN_Siren_TriggerReact"),yield s.Delay(.5),this.main.bigWinGroup.active=!0,this.playParticle(),this.main.bigWinDecorationAnim01.node.active=!0,this.main.bigWinDecorationAnim02.node.active=!0,cc.tween(this.main.bigWinDecorationAnim01.node).to(0,{scaleX:5,scaleY:5}).to(.3,{scaleX:2,scaleY:2}).call(()=>{this.main.bigWinDecorationAnim01.play("alarm-warn")}).start(),cc.tween(this.main.bigWinDecorationAnim02.node).to(0,{scaleX:5,scaleY:5}).to(.3,{scaleX:2,scaleY:2}).call(()=>{this.main.bigWinDecorationAnim02.play("alarm-warn")}).start(),l.default.getInstance().play("STD_ALLWIN_BigText_IN",!0),l.default.getInstance().play("STD_ALLWIN_Siren",!0);let a="";switch(e){case m.BigWinType.BigWin:a="bigwin",t=this.main.animationConfig.delayTime.BigWin;break;case m.BigWinType.MegaBigWin:a="megawin",t=this.main.animationConfig.delayTime.MegaBigWin;break;case m.BigWinType.SuperBigWin:a="superwin",t=this.main.animationConfig.delayTime.SuperBigWin;break;case m.BigWinType.UltraBigWin:a="ultrawin",t=this.main.animationConfig.delayTime.UltraBigWin;break;case m.BigWinType.UltraMegaBigWin:a="ultramegawin",t=this.main.animationConfig.delayTime.UltraMegaBigWin}this.main.bigWinGroup.getComponent(cc.Animation).play(a),g.default.getInstance().addEvent("SpaceOrSpinButton","ShowBigWinAnim",()=>{r.gg.eventManager.emit("BigWinAnim.OnSpaceOrSpinButtonDown")}),r.gg.eventManager.emit("HUDPrefab.OnSpinButtonUpdate","disable"),yield s.SkippableDelay(5,"BigWinAnim.OnSpaceOrSpinButtonDown"),r.gg.eventManager.emit("HUDPrefab.OnSpinButtonUpdate","enable");const o=t-5;yield s.SkippableDelay(cc.misc.clampf(o,0,o),"BigWinAnim.OnSpaceOrSpinButtonDown"),g.default.getInstance().removeEventById("SpaceOrSpinButton","ShowBigWinAnim")})}playParticle(){return a(this,void 0,void 0,function*(){this.main.coinRainPrefab01.active=!0,yield s.Delay(.2),this.main.coinRainPrefab02.active=!0,yield s.Delay(.3),this.main.coinRainPrefab03.active=!0,yield s.Delay(.2),this.main.coinRainPrefab04.active=!0})}resetParticle(){this.main.coinRainPrefab01.active=!1,this.main.coinRainPrefab02.active=!1,this.main.coinRainPrefab03.active=!1,this.main.coinRainPrefab04.active=!1}stopAllAnimation(){this.main.bigWinGraphicTextAnim.stop(),this.main.bigWinDecorationAnim01.stop(),this.main.bigWinDecorationAnim02.stop(),this.main.bigWinLightAnim.stop(),this.main.bigWinDecorationAnim01.node.active=!1,this.main.bigWinDecorationAnim02.node.active=!1,this.resetParticle()}stopAllSoundEffect(){l.default.getInstance().stop(["STD_ALLWIN_BigText_IN","STD_ALLWIN_Siren"]),l.default.getInstance().play("STD_ALLWIN_BigText_OUT")}setupBigWinAnimModule(){p.default.init()}registerEvent(){r.gg.eventManager.on("SlotEnginePrefab.OnSpinStarted",this.onSpinStartedOrByReel,this),r.gg.eventManager.on("SlotEnginePrefab.OnSpinStartedByReel",this.onSpinStartedOrByReel,this),r.gg.eventManager.on("HUDPrefab.onWiningLineAndSymbolClear",this.onSpinStartedOrByReel,this)}setupAnimationConfig(){this.main.animationConfig={delayTime:{BigWin:6,MegaBigWin:9,SuperBigWin:7,UltraBigWin:11,UltraMegaBigWin:14}}}cachePropertyNode(){this.main.bigWinGroup=this.bigWinGroup,this.main.coinRainPrefab01=this.coinRainPrefab01,this.main.coinRainPrefab02=this.coinRainPrefab02,this.main.coinRainPrefab03=this.coinRainPrefab03,this.main.coinRainPrefab04=this.coinRainPrefab04}cacheAnimationNode(){this.main.bigWinBackground=this.bigWinBackground,this.main.bigWinGraphicTextAnim=this.bigWinGraphicText.getComponent(cc.Animation),this.main.bigWinDecorationAnim01=this.bigWinDecoration01.getComponent(cc.Animation),this.main.bigWinDecorationAnim02=this.bigWinDecoration02.getComponent(cc.Animation),this.main.bigWinLightAnim=this.bigWinLight.getComponent(cc.Animation)}onSpinStartedOrByReel(){r.gg.eventManager.emit("BigWinAnim.OnSpaceOrSpinButtonDown"),this.main.bigWinGroup.active&&(this.stopAllAnimation(),this.stopAllSoundEffect(),this.main.bigWinGroup.active=!1,c.GlobalData.flags.bigWinShowing=!1)}loadBigWinAnimAssets(){return a(this,void 0,void 0,function*(){return new Promise(i=>{cc.assetManager.loadBundle("kiss918-bigwin",(n,e)=>{if(n)return console.error(n);const t=s.AsyncTask(i=>a(this,void 0,void 0,function*(){e.load(["common/sounds/STD_ALLWIN_BigText_IN","common/sounds/STD_ALLWIN_BigText_OUT","common/sounds/STD_ALLWIN_Siren","common/sounds/STD_ALLWIN_Siren_TriggerReact"],cc.AudioClip,(i,n)=>{l.default.getInstance().addAll(n)});let n=this.main.bigWinGroup.getComponent(cc.Animation);e.load(["animation/bigwin","animation/megawin","animation/superwin","animation/ultrawin","animation/ultramegawin"],cc.AnimationClip,(i,e)=>{if(e.length>0)for(const t of e)n.addClip(t)}),e.load(["animation/bigwin-firework-blue","animation/bigwin-firework-green","animation/bigwin-firework-red","animation/bigwin-firework-white"],cc.AnimationClip,(i,n)=>{this.main.coinRainPrefab01.getComponent(cc.Animation).addClip(n[0]),this.main.coinRainPrefab01.getComponent(u.default).particleAnimationName=n[0].name,this.main.coinRainPrefab02.getComponent(cc.Animation).addClip(n[1]),this.main.coinRainPrefab02.getComponent(u.default).particleAnimationName=n[1].name,this.main.coinRainPrefab03.getComponent(cc.Animation).addClip(n[2]),this.main.coinRainPrefab03.getComponent(u.default).particleAnimationName=n[2].name,this.main.coinRainPrefab04.getComponent(cc.Animation).addClip(n[3]),this.main.coinRainPrefab04.getComponent(u.default).particleAnimationName=n[3].name}),e.load("animation/alarm-warn",cc.AnimationClip,(n,e)=>{this.main.bigWinDecorationAnim01.addClip(e),this.main.bigWinDecorationAnim02.addClip(e),this.main.bigWinDecorationAnim01.node.active=!1,this.main.bigWinDecorationAnim02.node.active=!1,i()})}));Promise.all([t]).then(()=>{i()})})})})}};t([h(cc.Node)],f.prototype,"bigWinBackground",void 0),t([h(cc.Node)],f.prototype,"bigWinGroup",void 0),t([h(cc.Node)],f.prototype,"bigWinDecoration01",void 0),t([h(cc.Node)],f.prototype,"bigWinDecoration02",void 0),t([h(cc.Node)],f.prototype,"bigWinLight",void 0),t([h(cc.Node)],f.prototype,"bigWinGraphicText",void 0),t([h(cc.Node)],f.prototype,"coinRainPrefab01",void 0),t([h(cc.Node)],f.prototype,"coinRainPrefab02",void 0),t([h(cc.Node)],f.prototype,"coinRainPrefab03",void 0),t([h(cc.Node)],f.prototype,"coinRainPrefab04",void 0),f=t([d],f),e.default=f,cc._RF.pop()},{"../../../../scripts/GlobalData":void 0,"../../../../scripts/HelperTools":void 0,"../../../../scripts/framework/gg":void 0,"../../../../scripts/manager/AudioManager":void 0,"../../../../scripts/manager/EventQueueManager":void 0,"./Kiss918BigWinAnimEnum":"Kiss918BigWinAnimEnum","./Kiss918BigWinAnimModule":"Kiss918BigWinAnimModule","./Kiss918FireworkPrefab":"Kiss918FireworkPrefab"}],Kiss918FireworkPrefab:[function(i,n,e){"use strict";cc._RF.push(n,"ba727WhiSZGhpd9ZwSkSzaS","Kiss918FireworkPrefab");var t=this&&this.__decorate||function(i,n,e,t){var a,o=arguments.length,r=o<3?n:null===t?t=Object.getOwnPropertyDescriptor(n,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,n,e,t);else for(var c=i.length-1;c>=0;c--)(a=i[c])&&(r=(o<3?a(r):o>3?a(n,e,r):a(n,e))||r);return o>3&&r&&Object.defineProperty(n,e,r),r};Object.defineProperty(e,"__esModule",{value:!0});const{ccclass:a,property:o}=cc._decorator;class r{static freeze(i){this.cachedFreezeUpdate=Object.assign(i.lateUpdate),i.lateUpdate=function(){}}static unfreeze(i){i.lateUpdate=this.cachedFreezeUpdate}}let c=class extends cc.Component{constructor(){super(...arguments),this.particleAnimationName="",this.main={particleSystem:null,particleAnimation:null}}onLoad(){this.cacheRainPorperty()}start(){}onEnable(){this.playSpreadAnimation()}onDisable(){this.stopSpreadAnimation()}freeze(){r.freeze(this.main.particleSystem)}unfreeze(){r.unfreeze(this.main.particleSystem)}cacheRainPorperty(){this.main.particleSystem=this.node.getComponent(cc.ParticleSystem),this.main.particleAnimation=this.node.getComponent(cc.Animation)}playSpreadAnimation(){this.particleAnimationName&&this.main.particleAnimation.play(this.particleAnimationName)}stopSpreadAnimation(){this.particleAnimationName&&this.main.particleAnimation.stop(),this.main.particleSystem.resetSystem()}};t([o],c.prototype,"particleAnimationName",void 0),c=t([a],c),e.default=c,cc._RF.pop()},{}]},{},["Kiss918BigWinAnimEnum","Kiss918BigWinAnimModel","Kiss918BigWinAnimModule","Kiss918BigWinAnimPrefab","Kiss918FireworkPrefab"]);