window.__require=function e(t,o,a){function r(i,s){if(!o[i]){if(!t[i]){var c=i.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);if("object"==typeof __quick_compile_project__&&__quick_compile_project__){for(var p=i.split("/"),u="",d=p.length;d>0;)p[d]&&".."!=p[d]&&(u="/"+p[d]+u),d--;return c="./assets"+u,__quick_compile_project__.require(c,"preview-scripts/__qc_index__.js")}throw new Error("Cannot find module '"+i+"'")}i=c}var h=o[i]={exports:{}};t[i][0].call(h.exports,function(e){return r(t[i][1][e]||e)},h,h.exports,e,t,o,a)}return o[i].exports}for(var n="function"==typeof __require&&__require,i=0;i<a.length;i++)r(a[i]);return r}({Kiss918JackpotProgressionModule:[function(e,t,o){"use strict";cc._RF.push(t,"805f6yZYmxI5aRiYiEefeJh","Kiss918JackpotProgressionModule"),Object.defineProperty(o,"__esModule",{value:!0}),o.Kiss918JackpotType=void 0;const a=e("../../../../../scripts/HelperTools");var r;(function(e){e[e.Minor=1]="Minor",e[e.Random=2]="Random",e[e.Major=3]="Major"})(r=o.Kiss918JackpotType||(o.Kiss918JackpotType={}));class n extends cc.Component{static getJackpotAmount(e){let t=0;switch(e){case r.Major:t=a.GetRandomFloat(2e4,25e4);break;case r.Random:t=this.random+a.GetRandomFloat(.1,.9),this.random=t;break;case r.Minor:t=a.GetRandomFloat(5e3,6e4)}return t}static init(){this.random=a.GetRandomFloat(23e4,11e5)}}o.default=n,n.random=0,cc._RF.pop()},{"../../../../../scripts/HelperTools":void 0}],Kiss918JackpotProgressionPrefab:[function(e,t,o){"use strict";cc._RF.push(t,"f5fc5UGkGlOwJZYtqHz5Y8v","Kiss918JackpotProgressionPrefab");var a=this&&this.__createBinding||(Object.create?function(e,t,o,a){void 0===a&&(a=o),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,a){void 0===a&&(a=o),e[a]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__decorate||function(e,t,o,a){var r,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(n<3?r(i):n>3?r(t,o,i):r(t,o))||i);return n>3&&i&&Object.defineProperty(t,o,i),i},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&a(t,e,o);return r(t,e),t},s=this&&this.__awaiter||function(e,t,o,a){return new(o||(o=Promise))(function(r,n){function i(e){try{c(a.next(e))}catch(t){n(t)}}function s(e){try{c(a.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(i,s)}c((a=a.apply(e,t||[])).next())})},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});const l=e("../../../../../scripts/framework/gg"),p=e("../../../../../scripts/framework/lib/router/PanelComponent"),u=e("../../../../../scripts/HelperTools"),d=c(e("../../../../../scripts/manager/AudioManager")),h=i(e("../../../../../scripts/manager/CreditCoinConvertorManager")),g=c(e("../../../../../scripts/manager/GameSystemManager")),k=i(e("./Kiss918JackpotProgressionModule")),{ccclass:m,property:f}=cc._decorator;let J=class extends p.PanelComponent{constructor(){super(...arguments),this.jackpotBg=null,this.labelMajor=null,this.labelRandom=null,this.labelMinor=null,this.wonAmountObj={}}onLoad(){this.labelMajor.string="0",this.labelRandom.string="0",this.labelMinor.string="0",this.registerEvent()}start(){return s(this,void 0,void 0,function*(){yield this.loadJackpotAssets(),this.setupJackpotModule()})}show(e){e.onShowed()}hide(e){e.onHided()}registerEvent(){l.gg.eventManager.on("JackporPanelEvent.UpdateJackpotProgression",this.onCountingBalance,this),l.gg.eventManager.on("JackporPanelEvent.ResetJackpotProgression",this.resetJackpotWonCounter,this),l.gg.eventManager.on("JackporPanelEvent.OnJackpotWon",this.onTriggerJackpotWin,this)}setupJackpotModule(){return s(this,void 0,void 0,function*(){k.default.init(),this.updateMinorJackpot(),this.updateMajorJackpot(),this.updateRandomJackpot(),this.registerMajorJackpotSchedule(),this.registerRandomJackpotSchedule(),this.registerMinorJackpotSchedule(),this.addLabelForCreditCoinUpdate()})}updateMinorJackpot(){const e=k.default.getJackpotAmount(k.Kiss918JackpotType.Minor);this.labelMinor.string=h.CCConvertor(e.toFixed(2))}updateMajorJackpot(){const e=k.default.getJackpotAmount(k.Kiss918JackpotType.Major);this.labelMajor.string=h.CCConvertor(e.toFixed(2))}updateRandomJackpot(){const e=k.default.getJackpotAmount(k.Kiss918JackpotType.Random);this.labelRandom.string=h.CCConvertor(e.toFixed(2))}registerMajorJackpotSchedule(){this.schedule(this.updateMajorJackpot,1,1/0,0)}registerRandomJackpotSchedule(){this.schedule(this.updateRandomJackpot,.1,1/0,0)}registerMinorJackpotSchedule(){this.schedule(this.updateMinorJackpot,1,1/0,0)}addLabelForCreditCoinUpdate(){h.default.getInstance().addLabelSprite(this.labelMajor),h.default.getInstance().addLabelSprite(this.labelMinor),h.default.getInstance().addLabelSprite(this.labelRandom)}onCountingBalance(e){return s(this,void 0,void 0,function*(){switch(console.warn("Jackpot Won Popup -> Progression Reducer"),this.wonAmountObj={amount:Number(e.jackpotWonAmount)},e.type){case k.Kiss918JackpotType.Major:this.unschedule(this.updateMajorJackpot),this.labelMajor.node.color=cc.Color.RED,this.labelMajor.string=e.jackpotWonAmount,this.jackpotWonAmountReducer(this.labelMajor,this.wonAmountObj,e.maxJackpotAnimTime);break;case k.Kiss918JackpotType.Random:this.unschedule(this.updateRandomJackpot),this.labelRandom.node.color=cc.Color.RED,this.labelRandom.string=e.jackpotWonAmount,this.jackpotWonAmountReducer(this.labelRandom,this.wonAmountObj,e.maxJackpotAnimTime);break;case k.Kiss918JackpotType.Minor:this.unschedule(this.updateMinorJackpot),this.labelMinor.node.color=cc.Color.RED,this.labelMinor.string=e.jackpotWonAmount,this.jackpotWonAmountReducer(this.labelMinor,this.wonAmountObj,e.maxJackpotAnimTime),this.labelMinor.node.color=cc.Color.RED}})}jackpotWonAmountReducer(e,t,o){let a=0;const r=h.default.getInstance().getConvertionType()===h.CCConvertionType.Coin?0:2;h.default.getInstance().enable=!1,d.default.getInstance().play("Sfx_CoinLoop",!0),cc.tween(t).to(o,{amount:0},{progress:(t,o,n,i)=>(a=cc.misc.lerp(t,o,i),e.string=a.toFixed(r),a)}).call(()=>{e.string="0",h.default.getInstance().enable=!0,d.default.getInstance().stop("Sfx_CoinLoop")}).start()}resetJackpotWonCounter(e){switch(cc.Tween.stopAllByTarget(this.wonAmountObj),e){case k.Kiss918JackpotType.Major:this.labelMajor.node.color=cc.Color.WHITE,this.updateMajorJackpot(),this.registerMajorJackpotSchedule();break;case k.Kiss918JackpotType.Random:this.labelRandom.node.color=cc.Color.WHITE,this.updateRandomJackpot(),this.registerRandomJackpotSchedule();break;case k.Kiss918JackpotType.Minor:this.labelMinor.node.color=cc.Color.WHITE,this.updateMinorJackpot(),this.registerMinorJackpotSchedule()}}onTriggerJackpotWin(){}loadJackpotAssets(){return new Promise(e=>{cc.assetManager.loadBundle("kiss918-jackpot-progression",(t,o)=>{if(t)return console.error(t);const a=`textures/${g.default.getInstance().getLanguageCode()}`,r=u.AsyncTask(e=>s(this,void 0,void 0,function*(){o.load(`${a}/Jackpot`,cc.SpriteFrame,(t,o)=>{this.jackpotBg.spriteFrame=o,e()})}));Promise.all([r]).then(()=>{e()})})})}};n([f(cc.Sprite)],J.prototype,"jackpotBg",void 0),n([f(cc.Label)],J.prototype,"labelMajor",void 0),n([f(cc.Label)],J.prototype,"labelRandom",void 0),n([f(cc.Label)],J.prototype,"labelMinor",void 0),J=n([m],J),o.default=J,cc._RF.pop()},{"../../../../../scripts/HelperTools":void 0,"../../../../../scripts/framework/gg":void 0,"../../../../../scripts/framework/lib/router/PanelComponent":void 0,"../../../../../scripts/manager/AudioManager":void 0,"../../../../../scripts/manager/CreditCoinConvertorManager":void 0,"../../../../../scripts/manager/GameSystemManager":void 0,"./Kiss918JackpotProgressionModule":"Kiss918JackpotProgressionModule"}]},{},["Kiss918JackpotProgressionModule","Kiss918JackpotProgressionPrefab"]);