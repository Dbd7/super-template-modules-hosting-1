window.__require=function t(n,e,a){function o(c,r){if(!e[c]){if(!n[c]){var p=c.split("/"),s=p,l=c;if(s=s[s.length-1],p.length>1&&(window.cachePath[s]=c),!n[s]){var m="function"==typeof __require&&__require;if(!r&&m)return m(s,!0);if(i)return i(s,!0);if("object"==typeof __quick_compile_project__&&__quick_compile_project__){var u=window.cachePath[s];u&&(l=u);for(var d=l.split("/"),k="",h=d.length;h>0;)d[h]&&".."!=d[h]&&(k="/"+d[h]+k),h--;return s="./assets"+k,__quick_compile_project__.require(s,"preview-scripts/__qc_index__.js")}throw new Error("Cannot find module '"+c+"'")}c=s}var J=e[c]={exports:{}};n[c][0].call(J.exports,function(t){return o(n[c][1][t]||t)},J,J.exports,t,n,e,a)}return e[c].exports}window.cachePath={};for(var i="function"==typeof __require&&__require,c=0;c<a.length;c++)o(a[c]);return o}({JackpotCoinRainPrefab:[function(t,n,e){"use strict";cc._RF.push(n,"06cea7QAMpMM5mWoFX5oEiz","JackpotCoinRainPrefab");var a=this&&this.__decorate||function(t,n,e,a){var o,i=arguments.length,c=i<3?n:null===a?a=Object.getOwnPropertyDescriptor(n,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,n,e,a);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(c=(i<3?o(c):i>3?o(n,e,c):o(n,e))||c);return i>3&&c&&Object.defineProperty(n,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});const{ccclass:o,property:i}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.coinParticleAnimationName="",this.main={coinParticle:null,coinParticleAnimation:null}}onLoad(){this.cacheCoinRainPorperty()}start(){}onEnable(){this.playCoinSpreadAnimation()}onDisable(){this.stopCoinSpreadAnimation()}cacheCoinRainPorperty(){this.main.coinParticle=this.node.getComponent(cc.ParticleSystem),this.main.coinParticleAnimation=this.node.getComponent(cc.Animation)}playCoinSpreadAnimation(){this.coinParticleAnimationName&&this.main.coinParticleAnimation.play(this.coinParticleAnimationName)}stopCoinSpreadAnimation(){this.coinParticleAnimationName&&this.main.coinParticleAnimation.stop(),this.main.coinParticle.resetSystem()}};a([i],c.prototype,"coinParticleAnimationName",void 0),c=a([o],c),e.default=c,cc._RF.pop()},{}],JackpotPanelConst:[function(t,n,e){"use strict";cc._RF.push(n,"da1fak31FtOYZxetpVOeohU","JackpotPanelConst"),Object.defineProperty(e,"__esModule",{value:!0}),e.JackpotPanelConst=void 0,e.JackpotPanelConst={CacheKey:"game.cache"},cc._RF.pop()},{}],JackpotPanelEnum:[function(t,n,e){"use strict";cc._RF.push(n,"446c73nmCNDkYTSD+8a+ZNM","JackpotPanelEnum"),Object.defineProperty(e,"__esModule",{value:!0}),e.JackpotType=void 0,function(t){t[t.Minor=1]="Minor",t[t.Major=2]="Major",t[t.Random=3]="Random"}(e.JackpotType||(e.JackpotType={})),cc._RF.pop()},{}],JackpotPanelEvent:[function(t,n,e){"use strict";cc._RF.push(n,"ec8aaWbXDpBU7Tl8BZe3jX5","JackpotPanelEvent"),Object.defineProperty(e,"__esModule",{value:!0}),e.JackporPanelEvent=void 0,(e.JackporPanelEvent||(e.JackporPanelEvent={})).OnJackpotWon="JackporPanelEvent.OnJackpotWon",cc._RF.pop()},{}],JackpotPanelModel:[function(t,n,e){"use strict";cc._RF.push(n,"cda54LE0HFCGL9KzYVtVHnJ","JackpotPanelModel"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.jackpotCounterAmount={major:0,random:0,minor:0},this.jackpoWonResult=null}},cc._RF.pop()},{}],JackpotPanelModule:[function(t,n,e){"use strict";cc._RF.push(n,"f5c9dc6EqBFSKT+55fVn0JE","JackpotPanelModule");var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=t("../../../../scripts/HelperTools"),i=t("./JackpotPanelEnum"),c=a(t("./JackpotPanelModel"));class r extends cc.Component{static getJackpotPanelModule(){return this}static getJackpotAmount(t){let n=0;switch(t){case i.JackpotType.Major:n=o.GetRandomFloat(2e4,25e4),this.data.jackpotCounterAmount.major=n;break;case i.JackpotType.Random:n=this.data.jackpotCounterAmount.random+o.GetRandomFloat(.1,.9),this.data.jackpotCounterAmount.random=n;break;case i.JackpotType.Minor:n=o.GetRandomFloat(5e3,6e4),this.data.jackpotCounterAmount.minor=n}return n}static setJackpoWonResult(t){this.data.jackpoWonResult=t}static init(){this.data=new c.default,this.data.jackpotCounterAmount.minor=0,this.data.jackpotCounterAmount.random=o.GetRandomFloat(23e4,11e5),this.data.jackpotCounterAmount.major=0}static saveSettingConfig(){}}e.default=r,r.data=null,cc._RF.pop()},{"../../../../scripts/HelperTools":void 0,"./JackpotPanelEnum":"JackpotPanelEnum","./JackpotPanelModel":"JackpotPanelModel"}],JackpotPanelPrefab:[function(t,n,e){"use strict";cc._RF.push(n,"1b581ER5aNL/oJKkK70wU6n","JackpotPanelPrefab");var a=this&&this.__createBinding||(Object.create?function(t,n,e,a){void 0===a&&(a=e),Object.defineProperty(t,a,{enumerable:!0,get:function(){return n[e]}})}:function(t,n,e,a){void 0===a&&(a=e),t[a]=n[e]}),o=this&&this.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),i=this&&this.__decorate||function(t,n,e,a){var o,i=arguments.length,c=i<3?n:null===a?a=Object.getOwnPropertyDescriptor(n,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,n,e,a);else for(var r=t.length-1;r>=0;r--)(o=t[r])&&(c=(i<3?o(c):i>3?o(n,e,c):o(n,e))||c);return i>3&&c&&Object.defineProperty(n,e,c),c},c=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)"default"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&a(n,t,e);return o(n,t),n},r=this&&this.__awaiter||function(t,n,e,a){return new(e||(e=Promise))(function(o,i){function c(t){try{p(a.next(t))}catch(n){i(n)}}function r(t){try{p(a.throw(t))}catch(n){i(n)}}function p(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e(function(t){t(n)})).then(c,r)}p((a=a.apply(t,n||[])).next())})},p=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=t("../../../../scripts/framework/gg"),l=t("../../../../scripts/framework/lib/router/PanelComponent"),m=t("../../../../scripts/HelperTools"),u=p(t("../../../../scripts/manager/AudioManager")),d=p(t("../../../../scripts/manager/BankManager")),k=c(t("../../../../scripts/manager/CreditCoinConvertorManager")),h=p(t("../../../../scripts/manager/EventQueueManager")),J=p(t("../../../../scripts/manager/GameSystemManager")),f=t("./JackpotPanelEnum"),g=p(t("./JackpotPanelModule")),{ccclass:P,property:v}=cc._decorator;let A=class extends l.PanelComponent{constructor(){super(...arguments),this.jackpotWiningPanel=null,this.labelJackpotWiningPanelAmount=null,this.jackpotWiningBg=null,this.minorJackpotAnimation=null,this.randomJackpotAnimation=null,this.majorJackpotAnimation=null,this.coinRainPrefab01=null,this.minJackpotAnimTime=10,this.maxJackpotAnimTime=30,this.cacheAnimation=null,this.hasConsole=!1}onLoad(){this.registerEvent()}start(){return r(this,void 0,void 0,function*(){yield this.loadJackpotAssets(),this.setupJackpotModule()})}show(t){t.onShowed()}hide(t){t.onHided()}triggerJackpot(){g.default.setJackpoWonResult({jackpotType:f.JackpotType.Major,amount:1e3}),s.gg.eventManager.emit("JackporPanelEvent.OnJackpotWon"),cc.find("SafeArea/BtnTriggerJackpot",this.node).active=!1}registerEvent(){this.hasConsole&&console.warn("---Jackpot Panel Prefab--- Register Event"),s.gg.eventManager.on("JackporPanelEvent.OnJackpotWon",this.onStartJackpotWonAnimation,this)}setupJackpotModule(){return r(this,void 0,void 0,function*(){g.default.init(),this.addLabelForCreditCoinUpdate()})}addLabelForCreditCoinUpdate(){k.default.getInstance().addLabelSprite(this.labelJackpotWiningPanelAmount)}onStartJackpotWonAnimation(t){return r(this,void 0,void 0,function*(){this.hasConsole&&(console.warn("Jackpot Win Start !!!"),console.log("Jackpot Win Param:",t)),g.default.setJackpoWonResult({jackpotType:t.jackpotType,amount:t.amount}),g.default.data.jackpoWonResult.amount>0&&g.default.data.jackpoWonResult.jackpotType>0||(this.coinRainPrefab01.active=!0,this.jackpotAnimStateMachine=this.createjackpotAnimStateMachine(),this.hasConsole&&console.warn("Manually Update Balance !!!"),d.default.getInstance().deposit(t.amount),s.gg.eventManager.emit("HUDPrefab.ManuallyUpdateBalanceOnce"),yield this.jackpotAnimStateMachine.showJackpotWon(),yield this.jackpotAnimStateMachine.countingBalance(),yield this.jackpotAnimStateMachine.hideJackpotWin(),this.coinRainPrefab01.active=!1,g.default.data.jackpoWonResult=null,this.jackpotAnimStateMachine=null,this.hasConsole&&console.warn("Jackpot Win Finish !!!"))})}createjackpotAnimStateMachine(){return new StateMachine({init:"idle",transitions:[{name:"showJackpotWon",from:"idle",to:"showWining"},{name:"countingBalance",from:"showWining",to:"showCounting"},{name:"hideJackpotWin",from:"showCounting",to:"idle"}],methods:{onShowJackpotWon:()=>this.onShowJackpotWon(),onCountingBalance:()=>this.onCountingBalance(),onHideJackpotWin:()=>this.onHideJackpotWon()}})}onShowJackpotWon(){return r(this,void 0,void 0,function*(){switch(this.hasConsole&&console.warn("Show Jackpot Win..."),u.default.getInstance().play("JackpotWinningBGM",!0),g.default.data.jackpoWonResult.jackpotType){case f.JackpotType.Major:this.cacheAnimation=this.majorJackpotAnimation.getComponent(cc.Animation),this.cacheAnimation.play("MajorJackpotAnim"),this.majorJackpotAnimation.node.active=!0;break;case f.JackpotType.Random:this.cacheAnimation=this.randomJackpotAnimation.getComponent(cc.Animation),this.cacheAnimation.play("RandomJackpotAnim"),this.randomJackpotAnimation.node.active=!0;break;case f.JackpotType.Minor:this.cacheAnimation=this.minorJackpotAnimation.getComponent(cc.Animation),this.cacheAnimation.play("MinorJackpotAnim"),this.minorJackpotAnimation.node.active=!0}this.labelJackpotWiningPanelAmount.string=k.CCConvertor(g.default.data.jackpoWonResult.amount.toFixed(2)),this.jackpotWiningPanel.opacity=0,this.jackpotWiningPanel.active=!0,cc.tween(this.jackpotWiningPanel).to(1,{opacity:255},{easing:"sineOut"}).call(()=>{const t=cc.tween().to(.25,{opacity:0}).delay(.25).to(.25,{opacity:255}).delay(1.5);cc.tween(this.jackpotWiningPanel).repeatForever(t).start()}).start()})}onCountingBalance(){return r(this,void 0,void 0,function*(){this.hasConsole&&console.warn("Start Counting Balance...");const t=k.CCConvertor(g.default.data.jackpoWonResult.amount.toFixed(2));let n=f.JackpotType.Major;switch(g.default.data.jackpoWonResult.jackpotType){case f.JackpotType.Major:n=f.JackpotType.Major;break;case f.JackpotType.Random:n=f.JackpotType.Random;break;case f.JackpotType.Minor:n=f.JackpotType.Minor}s.gg.eventManager.emit("JackporPanelEvent.UpdateJackpotProgression",{type:n,jackpotWonAmount:t,maxJackpotAnimTime:this.maxJackpotAnimTime}),h.default.getInstance().addEvent("SpaceOrSpinButton","ShowJackpotAnim",()=>{s.gg.eventManager.emit("JackpotWinAnim.OnSpaceOrSpinButtonDown")}),s.gg.eventManager.emit("HUDPrefab.OnSpinButtonUpdate","disable"),yield m.Delay(this.minJackpotAnimTime),s.gg.eventManager.emit("HUDPrefab.OnSpinButtonUpdate","enable"),yield m.SkippableDelay(this.maxJackpotAnimTime-this.minJackpotAnimTime,"JackpotWinAnim.OnSpaceOrSpinButtonDown"),h.default.getInstance().removeEventById("SpaceOrSpinButton","ShowJackpotAnim")})}onHideJackpotWon(){return r(this,void 0,void 0,function*(){this.hasConsole&&console.warn("Stop Jackpot Win..."),this.cacheAnimation.stop(),this.cacheAnimation=null,this.minorJackpotAnimation.node.active=!1,this.randomJackpotAnimation.node.active=!1,this.majorJackpotAnimation.node.active=!1,cc.Tween.stopAllByTarget(this.jackpotWiningPanel),yield m.AsyncTask(t=>r(this,void 0,void 0,function*(){cc.tween(this.jackpotWiningPanel).to(1,{opacity:0},{easing:"sineOut"}).call(()=>{this.labelJackpotWiningPanelAmount.string="0",this.jackpotWiningPanel.active=!1,u.default.getInstance().stop("JackpotWinningBGM"),u.default.getInstance().stop("Sfx_CoinLoop"),t()}).start()})),this.resetJackpotWonCounter(),cc.find("SafeArea/BtnTriggerJackpot",this.node).active=!0})}resetJackpotWonCounter(){switch(this.hasConsole&&console.warn("Reset Jackpot Progression..."),g.default.data.jackpoWonResult.jackpotType){case f.JackpotType.Major:s.gg.eventManager.emit("JackporPanelEvent.ResetJackpotProgression",f.JackpotType.Major);break;case f.JackpotType.Random:s.gg.eventManager.emit("JackporPanelEvent.ResetJackpotProgression",f.JackpotType.Random);break;case f.JackpotType.Minor:s.gg.eventManager.emit("JackporPanelEvent.ResetJackpotProgression",f.JackpotType.Minor)}}loadJackpotAssets(){return new Promise(t=>{cc.assetManager.loadBundle("jackpot-win",(n,e)=>{if(n)return console.error(n);const a=J.default.getInstance().getLanguageCode(),o=`textures/${a}`,i=m.AsyncTask(t=>r(this,void 0,void 0,function*(){e.load(["common/sounds/JackpotWinningBGM"],cc.AudioClip,(t,n)=>{u.default.getInstance().addAll(n)}),e.load("common/fonts/SafariBalanceNum",cc.BitmapFont,(t,n)=>{this.labelJackpotWiningPanelAmount.font=n}),e.load(`${o}/GameBonusPic`,cc.SpriteAtlas,(t,n)=>{const e=n.getSpriteFrame("GameBonusBG");this.jackpotWiningBg.spriteFrame=e}),e.load(`animation/${a}/MinorJackpotAnim`,cc.AnimationClip,(t,n)=>{this.minorJackpotAnimation.getComponent(cc.Animation).addClip(n)}),e.load(`animation/${a}/RandomJackpotAnim`,cc.AnimationClip,(t,n)=>{this.randomJackpotAnimation.getComponent(cc.Animation).addClip(n)}),e.load(`animation/${a}/MajorJackpotAnim`,cc.AnimationClip,(t,n)=>{this.majorJackpotAnimation.getComponent(cc.Animation).addClip(n)}),e.load("animation/JackpotWinCoinsParticleAnim",cc.AnimationClip,(n,e)=>{this.coinRainPrefab01.getComponent(cc.Animation).addClip(e),this.coinRainPrefab01.getComponent(cc.Animation).play("JackpotWinCoinsParticleAnim"),this.coinRainPrefab01.active=!1,t()})}));Promise.all([i]).then(()=>{t()})})})}};i([v(cc.Node)],A.prototype,"jackpotWiningPanel",void 0),i([v(cc.Label)],A.prototype,"labelJackpotWiningPanelAmount",void 0),i([v(cc.Sprite)],A.prototype,"jackpotWiningBg",void 0),i([v(cc.Sprite)],A.prototype,"minorJackpotAnimation",void 0),i([v(cc.Sprite)],A.prototype,"randomJackpotAnimation",void 0),i([v(cc.Sprite)],A.prototype,"majorJackpotAnimation",void 0),i([v(cc.Node)],A.prototype,"coinRainPrefab01",void 0),i([v({tooltip:"Min Jackpot animation Time"})],A.prototype,"minJackpotAnimTime",void 0),i([v({tooltip:"Max Jackpot animation Time"})],A.prototype,"maxJackpotAnimTime",void 0),A=i([P],A),e.default=A,cc._RF.pop()},{"../../../../scripts/HelperTools":void 0,"../../../../scripts/framework/gg":void 0,"../../../../scripts/framework/lib/router/PanelComponent":void 0,"../../../../scripts/manager/AudioManager":void 0,"../../../../scripts/manager/BankManager":void 0,"../../../../scripts/manager/CreditCoinConvertorManager":void 0,"../../../../scripts/manager/EventQueueManager":void 0,"../../../../scripts/manager/GameSystemManager":void 0,"./JackpotPanelEnum":"JackpotPanelEnum","./JackpotPanelModule":"JackpotPanelModule"}]},{},["JackpotCoinRainPrefab","JackpotPanelConst","JackpotPanelEnum","JackpotPanelEvent","JackpotPanelModel","JackpotPanelModule","JackpotPanelPrefab"]);